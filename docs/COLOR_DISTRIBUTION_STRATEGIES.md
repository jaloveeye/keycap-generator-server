# 키캡 색상 배치 전략

입력된 색상들을 키캡 레이아웃 그룹에 배치하는 다양한 전략을 제안합니다.

## 1. 색상 개수 기반 패턴 매칭 (현재 구현 중)

**방법**: 입력된 색상 개수와 동일한 색상 개수를 가진 기존 키캡 패턴을 찾아서 적용

**장점**:
- 실제 키캡 디자이너들이 사용한 패턴을 그대로 학습
- 자연스러운 색상 배치

**단점**:
- 동일한 색상 개수의 패턴이 없을 수 있음
- 색상 자체의 특성(밝기, 대비 등)은 고려하지 않음

**구현 예시**:
```typescript
// 3색 입력 → 3색 키캡 패턴 찾기
const patterns = findMatchingPatterns(allKeycaps, 3);
// 패턴: alpha=CR, modifier=N9, num=WS1
// 입력: [MG1, V2, CV]
// 결과: alpha=MG1, modifier=V2, num=CV (패턴의 순서대로)
```

---

## 2. 색상 유사도 기반 매칭

**방법**: 입력 색상과 기존 키캡의 색상을 비교하여 가장 유사한 색상 조합을 가진 패턴을 찾기

**장점**:
- 색상의 실제 특성(밝기, 채도, 색상)을 고려
- 유사한 색상 조합의 패턴을 자연스럽게 적용

**단점**:
- 색상 유사도 계산이 복잡
- 성능 오버헤드

**구현 예시**:
```typescript
// 입력: [MG1(#cb3d6e), V2(#ee6900), CV(#f8c200)]
// 기존 키캡 A: [RO1(#8d242f), V2(#ee6900), GE1(#ebd400)]
// → MG1과 RO1이 유사(빨간 계열), CV와 GE1이 유사(노란 계열)
// → 키캡 A의 패턴 적용
```

**색상 유사도 계산**:
- RGB 유클리드 거리
- LAB 색공간에서의 거리 (더 정확)
- 색상환(Hue) 기반 유사도

---

## 3. 색상 조합 빈도 기반 매칭

**방법**: 기존 키캡 데이터에서 특정 색상 조합이 어떤 그룹에 자주 사용되는지 통계를 내어 적용

**장점**:
- 데이터 기반의 객관적인 배치
- 가장 일반적인 패턴을 따름

**단점**:
- 정확히 동일한 색상 조합이 없을 수 있음
- 색상 순서는 고려하지 않음

**구현 예시**:
```typescript
// 통계: {CR, N9, WS1} 조합이 사용된 경우
// - alpha에 CR이 사용된 빈도: 85%
// - modifier에 N9가 사용된 빈도: 70%
// - num에 WS1이 사용된 빈도: 60%
// → 이 통계를 기반으로 배치
```

---

## 4. 그룹별 색상 빈도 기반 배치

**방법**: 각 그룹(alpha, modifier 등)에서 가장 자주 사용되는 색상 유형을 분석하여, 입력 색상 중 가장 적합한 것을 배치

**장점**:
- 그룹별 특성을 고려
- 간단하고 빠름

**단점**:
- 전체적인 색상 조합의 조화는 고려하지 않음
- 색상 개수가 적을 때 비효율적

**구현 예시**:
```typescript
// alpha 그룹: 어두운 색상(CR, N9)이 80% 사용
// modifier 그룹: 중간 밝기 색상이 60% 사용
// num 그룹: 밝은 색상(WS1, CP)이 70% 사용
// 
// 입력: [MG1(중간), V2(밝음), CV(밝음)]
// → alpha에 MG1, modifier에 V2, num에 CV
```

---

## 5. 색상 대비/조화 기반 배치

**방법**: 색상 이론(색상환, 대비, 조화)을 기반으로 가장 조화로운 배치를 계산

**장점**:
- 시각적으로 아름다운 결과
- 색상 이론 기반의 객관적 기준

**단점**:
- 복잡한 알고리즘 필요
- 기존 키캡 데이터를 활용하지 않음

**구현 예시**:
```typescript
// 입력: [MG1(마젠타), V2(오렌지), CV(노랑)]
// 색상환에서 보완색 관계 분석
// - MG1과 V2는 유사 색상 (따뜻한 계열)
// - CV는 강한 대비를 만듦
// → alpha에 MG1, legend에 CV (강한 대비)
// → modifier에 V2 (중간 톤)
```

**색상 이론 적용**:
- 보완색(Complementary)
- 유사색(Analogous)
- 삼원색(Triadic)
- 분할 보완(Split Complementary)

---

## 6. 레이아웃 타입 기반 매칭

**방법**: 레이아웃 타입(Base kit, Extension 등)별로 다른 패턴을 적용

**장점**:
- 레이아웃 특성에 맞는 배치
- 더 정확한 패턴 매칭

**단점**:
- 레이아웃 타입 정보가 필요
- 데이터가 부족할 수 있음

**구현 예시**:
```typescript
// Base kit 레이아웃: alpha에 주 색상, modifier에 보조 색상
// Extension 레이아웃: accent 색상 위주
// → 레이아웃 타입에 따라 다른 패턴 적용
```

---

## 추천 조합 전략

여러 전략을 조합하여 사용하는 것을 권장합니다:

1. **1차**: 색상 개수 기반 패턴 매칭 (가장 자연스러움)
2. **2차**: 색상 유사도 기반 매칭 (1차에서 매칭 실패 시)
3. **3차**: 그룹별 색상 빈도 기반 배치 (폴백)

또는:

1. **색상 개수 + 색상 유사도**: 동일한 색상 개수 중에서 가장 유사한 색상 조합 선택
2. **색상 조합 빈도 + 그룹별 빈도**: 두 통계를 결합하여 가중치 적용

---

## 구현 우선순위

1. ✅ **색상 개수 기반 패턴 매칭** (현재 구현 중)
2. **색상 유사도 기반 매칭** (다음 단계)
3. **그룹별 색상 빈도 기반 배치** (간단하고 효과적)
4. **색상 조합 빈도 기반 매칭** (통계 기반)
5. **색상 대비/조화 기반 배치** (고급 기능)

